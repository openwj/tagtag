## 目标
- 遵循“内置优先、重复封装、功能等价”，进一步统一查询写法、常量使用、配置注入与缓存策略，并补充测试。

## 查询优化（保留分页 XML，仅优化简单查询）
- User：已完成 `getByUsername` 使用 LambdaQuery；巡检是否有其它单表查询入口（如按邮箱/手机号），统一 LambdaQuery；对应未使用 XML 删除。
- Role：如存在按 `code/name` 的单条查询入口，改为 `lambdaQuery().eq(...).one()`；分页 `selectPage` XML 保留。
- Menu：如有按 `parentId` 获取列表、按 `menuCode` 获取单条，统一 LambdaQuery；分页 XML 保留。
- Dept：树构建已用 LambdaQuery，若存在按父 ID 简单列表查询入口，统一 LambdaQuery；分页 XML 保留。

## 安全常量统一
- 在 `SecurityConfig` 的 `JwtAuthenticationConverter` 中使用 `SecurityClaims.ROLES/PERMS` 读取 claims，移除魔法字符串。
- 巡检读取 `uid/uname/ver/typ` 的位置（如过滤器/服务），确保全部使用 `SecurityClaims` 常量。

## 配置集中与注入
- 继续将零散 `@Value` 改为 `@ConfigurationProperties`，重点：分页默认页大小、排序白名单可配置（必要时保留当前硬编码但预留属性类）。
- 巡检各模块 `config` 包，统一属性类命名与前缀（如 `iam.*`、`security.*`）。

## 缓存策略
- 在 `RoleServiceImpl.listMenuCodesByRoleIds` 已加缓存；评估 `DeptServiceImpl.listTree` 增加只读缓存（开发环境可禁用）。
- 若加缓存：在更新/删除部门时 `@CacheEvict(allEntries=true)`；避免脏读。

## 自动填充与实体注解
- 审核实体的审计字段注解：`@TableField(fill=INSERT/UPDATE)` 是否齐备，字段名一致（`createTime/updateTime/createBy/updateBy/deleted`）。
- 如缺失，补齐注解以让 `MetaObjectHandlerImpl` 一致生效（仅提示本批次计划，实现时逐文件补充）。

## 日志与校验
- 为关键服务添加轻量 `@Slf4j` 日志（上下文信息，不含敏感数据），异常分支使用统一文案常量。
- 控制器继续 `@Valid`，服务层仅保留防御校验；确保 `GlobalExceptionHandler` 输出一致。

## 测试与验证
- 增补 MockMvc 用例：
  - 登录成功/失败（空参、用户不存在、密码错误 → 400/401）
  - 刷新令牌版本不匹配 → 401；注销后旧令牌 → 401
  - 权限聚合一次查询与缓存命中
  - 简单查询（User/Role/Menu/Dept）与原 XML 行为等价
- dev 环境运行验证；全项目编译通过。

## 交付
- 提交批次三改动（仅涉及简单查询与常量替换、配置集中与可选缓存），所有方法含函数级注释；附构建与运行验证结果。