---
title: 身份管理 (IAM)
description: 身份与访问管理模块文档。
---

# 身份管理 (IAM)

**IAM (Identity and Access Management)** 模块负责系统的用户认证、授权以及组织架构管理。

## 数据模型

IAM 模块基于 RBAC (Role-Based Access Control) 模型设计。

### 用户 (User)
代表系统的操作员。
- **属性**: 用户名、密码 (BCrypt加密)、状态 (启用/禁用)、归属部门。
- **关联**: 一个用户可以拥有多个角色。

### 角色 (Role)
代表一组权限的集合。
- **功能**: 用于批量分配权限给用户。
- **数据权限**: 可以配置角色的数据访问范围（如：仅查看本部门数据）。

### 权限/菜单 (Permission/Menu)
代表系统中的功能资源。
- **类型**:
    - **目录 (Directory)**: 左侧菜单栏的分组。
    - **菜单 (Menu)**: 具体的页面入口。
    - **按钮 (Button)**: 页面内的功能操作（如：新增、删除）。
- **标识**: 如 `sys:user:add`，用于后端接口权限校验和前端按钮显示控制。

### 部门 (Dept)
代表企业的组织层级结构。
- **结构**: 树形结构，支持无限层级。
- **用途**: 用于构建组织架构树，以及作为数据权限的判定依据。

## 功能特性

### 1. 用户管理
- 用户的增删改查。
- 密码重置与状态变更。
- 分配角色。

### 2. 角色管理
- 角色的创建与维护。
- 分配菜单权限：通过树形选择器勾选菜单和按钮。
- 配置数据权限范围。

### 3. 菜单管理
- 可视化管理系统的菜单结构。
- 配置菜单图标、路由路径、组件路径。
- 定义按钮权限标识。

## 前端实现

前端相关代码位于 `tagtag-ui/apps/tagtag/src/views/modules/iam`。

| 功能 | 页面路径 | 描述 |
| :--- | :--- | :--- |
| 用户管理 | `/iam/user` | 用户列表、新增/编辑弹窗 |
| 角色管理 | `/iam/role` | 角色列表、权限分配抽屉 |
| 菜单管理 | `/iam/menu` | 菜单树形表格、图标选择 |
| 部门管理 | `/iam/dept` | 部门树形维护 |

### 权限控制

**前端控制**:
使用 `v-auth` 指令或 `AccessControl` 组件控制按钮显示。
```vue
<template>
  <button v-auth="'sys:user:add'">新增用户</button>
</template>
```

**后端控制**:
在 Controller 方法上使用注解进行拦截。
```java
@PreAuthorize("@ss.hasPermission('sys:user:add')")
public Result save(@RequestBody UserDTO user) { ... }
```

## API 参考

| 方法 | 端点 | 描述 |
| :--- | :--- | :--- |
| POST | `/users` | 创建新用户 |
| GET | `/users/{id}` | 获取用户详情 |
| POST | `/auth/login` | 用户登录 (返回 JWT) |
| GET | `/menus/routes` | 获取当前用户的动态路由 |
